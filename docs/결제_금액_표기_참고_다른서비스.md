# 결제 금액 표기 참고 (일본 서비스 · 엔화 기준)

LINE Pay(엔화) + Kaia(USDT)를 함께 쓰는 **일본 대상 서비스**에서, 금액을 어떻게 표기하는지 정리한 문서입니다.

---

## 1. 우리 서비스 정책 (일본 · 엔화 기준)

- **표기**: **엔(JPY)과 USDT 둘 다** 노출.  
  - 상점 리스트·구매 확인 팝업 모두 **¥1,500 / 1.0 USDT** 형식으로 표기.
- **LINE Pay**: 결제·정산·사용자 노출 모두 **엔(JPY)**. LINE Pay API(v3) 지원 통화에 **JPY** 포함.
- **Kaia**: **USDT** 단위로 결제·표기.
- **환율**: `USDT_TO_JPY` 상수(예: 150)로 1 USDT = N円 환산. 추후 서버/실시간 환율로 교체 가능.

---

## 2. 결제 수단별 단위

| 구분 | 표기 | 비고 |
|------|------|------|
| **LINE Pay** | **엔(JPY)** (예: ¥1,500) | 결제·정산이 엔화이므로 사용자에게도 엔으로 표시 |
| **Kaia(USDT)** | **USDT** (예: 1.0 USDT) | 온체인 결제 단위와 동일 |
| **둘 다 노출** | **¥X,XXX / Y.Y USDT** (엔 먼저, 일본 서비스이므로) | 리스트·팝업 동일 형식 |

---

## 3. 다른 서비스 참고

### 3-1. LINE Pay (공식)

- Request/Confirm API: **currency**에 **JPY** 사용, **amount**는 엔 단위 정수.
- 가맹점 UI에서도 **요청한 통화(JPY)로 금액 표기**하는 것이 일반적.

### 3-2. Klip / Kaia 생태계

- 토큰 수량(USDT 등)이 기준. **법정통화(원/엔) 표시는 디앱이 환율로 계산해 보조 표기**하는 패턴.

### 3-3. 디앱 UX 권장

- **리스트**: 주 통화(일본이면 엔) + 보조(USDT) 병기.
- **결제 직전**: 최종 금액을 엔·USDT 둘 다 보여주고, 적용 환율을 바꿀 수 있으면 “기준 환율” 정도 안내.

---

## 4. 구현 요약 (본 프로젝트)

- **game.js**
  - `TICKET_PRICE_USDT`, `USDT_TO_JPY` 로 엔 환산.
  - `formatPriceJpyUsdt(amount)` → `"¥1,500 / 1.0 USDT"` 형식.
  - 상점 리스트: `data-ticket-amount` 기준으로 `updateShopListPrices()` 호출 시 일괄 갱신.
- **구매 확인 팝업**: 결제 수단과 관계없이 **엔 / USDT 둘 다** 동일 형식으로 표기.

---

## 5. 참고 링크

- LINE Pay 온라인 결제 API (한국어): https://pay.line.me/documents/online_v3_ko.html  
- LINE MINI App 결제: https://developers.line.biz/en/docs/line-mini-app/develop/payment/  
- Klip App2App API: https://docs.klipwallet.com/tutorial/tutorial-a2a-rest-api  
